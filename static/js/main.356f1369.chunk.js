(this["webpackJsonp@evancharlton/zipper"]=this["webpackJsonp@evancharlton/zipper"]||[]).push([[0],[,,,,,,,,,,,function(e,t,n){e.exports=n(23)},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(6),o=n.n(c),u=n(2),l=(n(17),n(3)),i=n(1),f=[[4,57],[33,72]],s=Object(u.b)({key:"nummer-query",default:""}),d=Object(u.c)({key:"nummer-query-pattern",get:function(e){for(var t=(0,e.get)(s);t.length<4;)t+="x";return t}}),b={type:"FeatureCollection",features:[]},m=Object(u.b)({key:"data-payload",default:{}}),h=Object(u.c)({key:"data-payload-loaded",get:function(e){var t;return(null!==(t=(0,e.get)(m).level)&&void 0!==t?t:0)>2}}),p=Object(u.c)({key:"geo-results",get:function(e){var t,n=e.get;return null!==(t=n(m)[n(d)])&&void 0!==t?t:[]}}),j=Object(u.c)({key:"geojson-filtered",get:function(e){var t=(0,e.get)(p);return 0===t.length?b:{type:"FeatureCollection",name:"Zipper",features:t.map((function(e){return{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[e]}}}))}}}),g=[[Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER],[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER]],v=Object(u.c)({key:"geo-bounds",get:function(e){var t=e.get;if(!t(s))return f;var n=t(p);return 0===n.length?null:n.reduce((function(e,t){return function(e,t){var n=Object(i.a)(e,2),a=Object(i.a)(n[0],2),r=a[0],c=a[1],o=Object(i.a)(n[1],2),u=o[0],l=o[1],f=Object(i.a)(t,2),s=Object(i.a)(f[0],2),d=s[0],b=s[1],m=Object(i.a)(f[1],2),h=m[0],p=m[1];return[[Math.max(r,d),Math.max(c,b)],[Math.min(u,h),Math.min(l,p)]]}(e,t.reduce((function(e,t){var n=Object(i.a)(e,2),a=Object(i.a)(n[0],2),r=a[0],c=a[1],o=Object(i.a)(n[1],2),u=o[0],l=o[1],f=t,s=Object(i.a)(f,2),d=s[0],b=s[1];return[[Math.max(r,d),Math.max(c,b)],[Math.min(u,d),Math.min(l,b)]]}),g))}),g)}}),y=Object(u.b)({key:"mapbox-map",default:!1}),O=(n(18),function(){return r.a.createElement("span",{id:"forkongithub"},r.a.createElement("a",{href:"https://github.com/evancharlton/zipper"},"Fork me on GitHub"))}),E=(n(19),function(){var e=Object(u.e)(y),t=Object(u.e)(h);return e&&t?null:r.a.createElement("div",{className:"loading-layer"},r.a.createElement("div",{className:"lds-dual-ring"}),!e&&r.a.createElement("h3",null,"Loading map\u2026"),!t&&r.a.createElement("h3",null,"Loading data\u2026"))}),k=n(9),w=n.n(k);n(20);w.a.accessToken="pk.eyJ1IjoiZXZhbmNoYXJsdG9uIiwiYSI6ImNrZ205b2diejAyazQzNW9jajdud2J2NnMifQ.LwYUjS8uxTr2DxYoKoGykA";var N=function(){var e=Object(u.e)(j),t=Object(u.f)(y),n=Object(u.e)(v),c=Object(a.useState)(null),o=Object(i.a)(c,2),l=o[0],s=o[1],d=Object(a.useRef)(null),b=Object(a.useCallback)((function(e){d.current=e;var n=new w.a.Map({container:e,style:"mapbox://styles/mapbox/dark-v10",bounds:f});n.on("load",(function(){n.addSource("geojson-id",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.addLayer({id:"layer-id",type:"line",source:"geojson-id",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#fff","line-width":2,"line-opacity":.25}}),s(n),t(!0)}))}),[d,t]);return Object(a.useEffect)((function(){e&&l&&l.getSource("geojson-id").setData(e)}),[e,l]),Object(a.useEffect)((function(){l&&n&&l.fitBounds(n)}),[l,n]),r.a.createElement("div",{ref:b,style:{height:"100%"}})},M=function(e){var t=e.placeholder,n=e.value,c=e.onChange,o=Object(a.useCallback)((function(e){c(e.target.value.replace(/[^0-9]/,""))}),[c]),u=Object(a.useCallback)((function(e){var t=e.currentTarget.value;if(t){var n=+t.charAt(t.length-1);switch(e.key){case"ArrowUp":n+=1;break;case"ArrowDown":n-=1}n=(n+10)%10,t=t.replace(/[0-9]$/,String(n)),c(String(t))}}),[c]);return r.a.createElement("input",{style:{backgroundColor:"transparent",fontSize:20,border:"1px solid #fff3",borderRadius:5,padding:5,color:"#fffa"},maxLength:4,inputMode:"numeric",onKeyDown:u,onChange:o,placeholder:t,value:n,autoFocus:!0})},x=(n(21),function(){var e=Object(u.d)(s),t=Object(i.a)(e,2),n=t[0],a=t[1];return r.a.createElement("div",{className:"search-area"},r.a.createElement(M,{placeholder:"Postnummer",value:n,onChange:a}))}),S=(n(22),function(){var e=Object(u.f)(m),t=Object(u.e)(y);return Object(a.useEffect)((function(){if(t){var n=function(t){return fetch("".concat("/zipper","/clustered-").concat(t,".json")).then((function(e){return e.json()})).then((function(n){return e((function(e){return Object(l.a)({},e,{},n,{level:t})}))}))};n(0).then((function(){return n(1)})).then((function(){return n(2)})).then((function(){return n(3)})).then((function(){return n(4)}))}}),[t,e]),r.a.createElement(r.a.Fragment,null,r.a.createElement(N,null),r.a.createElement(x,null),r.a.createElement(E,null),r.a.createElement(O,null))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(u.a,null,r.a.createElement(S,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[11,1,2]]]);
//# sourceMappingURL=main.356f1369.chunk.js.map